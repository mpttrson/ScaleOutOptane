# ScaleOutOptane


XSA Project to provide statistics on a scale out system with Optane


UAA
------

Create xsuaa service called UAA-Service

Jobscheduler
------------

Create jobscheduler service called jobscheduler

User Provided Service
--------------------=

Create UPS called grantor-service

{
	"password": "n0tPassw0rd",
	"driver": "com.sap.db.jdbc.Driver",
	"port": "39015",
	"host": "hxehost",
	"user": "UserName",
	"tags": "hana"
}

Security
---------

Create container group admin

CREATE USER HDI_GROUP_ADMIN PASSWORD "n0tPassw0rd" NO FORCE_FIRST_PASSWORD_CHANGE;

CREATE LOCAL TEMPORARY COLUMN TABLE #PRIVILEGES LIKE _SYS_DI.TT_API_PRIVILEGES;
INSERT INTO #PRIVILEGES (PRINCIPAL_NAME, PRIVILEGE_NAME, OBJECT_NAME) SELECT 'HDI_GROUP_ADMIN', PRIVILEGE_NAME, OBJECT_NAME FROM _SYS_DI.T_DEFAULT_CONTAINER_GROUP_ADMIN_PRIVILEGES;
CALL _SYS_DI.GRANT_CONTAINER_GROUP_API_PRIVILEGES_WITH_GRANT_OPTION('SYS_XS_HANA_BROKER',# PRIVILEGES, _SYS_DI.T_NO_PARAMETERS, ?, ?, ?);
DROP TABLE #PRIVILEGES;

CREATE LOCAL TEMPORARY TABLE #PRIVILEGES LIKE _SYS_DI.TT_API_PRIVILEGES;
INSERT INTO #PRIVILEGES (PRINCIPAL_NAME, PRIVILEGE_NAME, OBJECT_NAME) SELECT 'HDI_GROUP_ADMIN', PRIVILEGE_NAME, OBJECT_NAME FROM _SYS_DI.T_DEFAULT_DI_ADMIN_PRIVILEGES;
CALL _SYS_DI.GRANT_CONTAINER_GROUP_API_PRIVILEGES('_SYS_DI', #PRIVILEGES, _SYS_DI.T_NO_PARAMETERS, ?, ?, ?);
DROP TABLE #PRIVILEGES;

--	Switch user to container group admin

CREATE LOCAL TEMPORARY COLUMN TABLE #PRIVILEGES LIKE _SYS_DI.TT_API_PRIVILEGES;
INSERT INTO #PRIVILEGES (PRINCIPAL_NAME, PRIVILEGE_NAME, OBJECT_NAME) SELECT 'UserName', 'EXECUTE', 'WRITE' FROM dummy;
INSERT INTO #PRIVILEGES (PRINCIPAL_NAME, PRIVILEGE_NAME, OBJECT_NAME) SELECT 'UserName', 'EXECUTE', 'MAKE' FROM dummy;
INSERT INTO #PRIVILEGES (PRINCIPAL_NAME, PRIVILEGE_NAME, OBJECT_NAME) SELECT 'UserName', 'EXECUTE', 'GRANT_CONTAINER_SCHEMA_PRIVILEGES' FROM dummy;
CALL _SYS_DI#SYS_XS_HANA_BROKER.GRANT_CONTAINER_API_PRIVILEGES('SCALEOUTOPTANE', # PRIVILEGES, _SYS_DI.T_NO_PARAMETERS, ?, ?, ?);
DROP TABLE #PRIVILEGES;

-- Make MickAdmin a container admin for SCALEOUTOPTANE

CREATE LOCAL TEMPORARY COLUMN TABLE #PRIVILEGES LIKE _SYS_DI.TT_SCHEMA_PRIVILEGES; 
INSERT INTO #PRIVILEGES ( PRIVILEGE_NAME, PRINCIPAL_SCHEMA_NAME, PRINCIPAL_NAME ) VALUES ( 'SELECT', '', 'MICKADMIN' ); 
CALL _SYS_DI#SYS_XS_HANA_BROKER.GRANT_CONTAINER_SCHEMA_PRIVILEGES( 'SCALEOUTOPTANE', #PRIVILEGES, _SYS_DI.T_NO_PARAMETERS, ?, ?, ?); 
DROP TABLE #PRIVILEGES; 

-- switch to Admin

GRANT "SCALEOUTOPTANE"."ScaleOutOptaneAdmin#" TO UserName with grant option;

GRANT CATALOG READ TO GRANT_REMOTE_SOURCES;

